"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.InjectQueue = exports.Processor = void 0;
const core_1 = require("@midwayjs/core");
const constants_1 = require("./constants");
function Processor(queueName, concurrency, jobOptions, queueOptions) {
    return function (target) {
        if (typeof concurrency !== 'number') {
            queueOptions = { ...jobOptions };
            jobOptions = { ...concurrency };
            concurrency = 1;
        }
        (0, core_1.saveModule)(constants_1.BULL_PROCESSOR_KEY, target);
        (0, core_1.saveClassMetadata)(constants_1.BULL_PROCESSOR_KEY, {
            queueName,
            concurrency,
            jobOptions,
            queueOptions,
        }, target);
        (0, core_1.Provide)()(target);
        (0, core_1.Scope)(core_1.ScopeEnum.Request)(target);
    };
}
exports.Processor = Processor;
function InjectQueue(queueName) {
    return (0, core_1.createCustomPropertyDecorator)(constants_1.BULL_QUEUE_KEY, {
        queueName,
    });
}
exports.InjectQueue = InjectQueue;
//# sourceMappingURL=decorator.js.map